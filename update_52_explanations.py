#!/usr/bin/env python3
"""
第52回の explanation を法的根拠・理由に基づく解説文（約100文字）に更新する。
第50回・第51回のデータは変更しない。
"""
import csv
import os

SCRIPT_DIR = os.path.dirname(os.path.abspath(__file__))
CSV_PATH = os.path.join(SCRIPT_DIR, "questions.csv")

# 第52回 学科 問1〜40 の解説（正解の法的根拠・理由）
EXPLANATIONS_52_学科 = [
    "特許法第35条。相当の利益を受ける権利は契約等で定めることができ、譲渡時に契約の定めがある場合に限り従業者が相当の利益を得る。",
    "著作権法第23条1項。公衆送信には自動公衆送信が含まれる。イの「含まれない」は誤りで不適切。",
    "意匠法第3条2項3号。電気通信回線を通じて公衆に利用可能となった意匠は、頒布に該当しないため登録を受けられる場合がある。",
    "Fターム・FIは日本独自の分類であり、付与ルールを正確に理解しないと検索漏れ・ノイズが生じる。Fタームは国際統一ではない。",
    "特許法69条により試験研究目的の使用・家庭内個人的使用は侵害とならない。他選択肢は誤り。転売は原則権利消尽だが、再販売禁止条件違反等一定の転売は侵害と評価される場合がある（正答はア）。",
    "商標法4条1項8号。他人の著名な筆名等は承諾を得れば登録可能。地方的に知られた名称のみ（同項16号）や商品略称のみは登録不可。",
    "著作権法32条。引用は「公正な慣行に合致し、かつ報道・批評等の正当な目的に供する」ことが必要。目的が文化発展でなければならないとするのは不適切。",
    "特許法32条。公衆の保健を害するおそれがある発明は特許を受けられない。出願公開請求は誰でも可能で、補完時の出願日は補完日となる。",
    "種苗法19条・20条。登録品種と特性により明確に区別されない品種（DUS未充足）を業として利用する権利を育成者権として専有する。",
    "特許法105条の2。損害額の算定では、侵害者が得た利益の額、実施料相当額、能力を超える数量も考慮し得る。警告書は必須ではない。",
    "特許法17条の2、53条。最初の拒絶理由通知後、補正により請求項を追加・細分して項数を増やすことは、要旨変更でなければ認められる場合がある。",
    "意匠法3条2項。自己の関連意匠にのみ類似する意匠は、本意匠の出願前の意匠と重複しなければ登録可能。建築物の不可欠形状等は登録不可。",
    "PCT条約。パリ条約の優先権はPCT出願でも主張可能。国内移行は30ヶ月以内。提出先は特許庁等でも可。",
    "関税法21条の12。輸入差止の認定を受けた物品は、税関長が裁判所の判決に基づき没収・廃棄等の処分を行う。著作隣接権侵害物も対象。",
    "意匠法10条。関連意匠は本意匠の出願日から10年以内（旧法は5年）に出願する必要がある。画像意匠は変化前後の画像を一意匠で登録可能。",
    "特許法17条の2、50条。進歩性欠如の最後の拒絶理由通知後も、同様の目的の補正は原則不可。出願審査請求がなくても方式審査等は行われる。",
    "商標法16条、24条。書体変更は要旨変更となるため補正不可。指定商品の減縮、分割移転、通常実施権の許諾は可能。",
    "民法96条、110条。錯誤に基づく取消しは善意無過失の第三者に対抗できない（96条3項）。重過失があっても相手方が悪意等なら取消し得る。",
    "著作権法15条2項。職務著作で法人等が著作者となる場合、著作者人格権はその法人等が有する。建築物の増改築は改変に該当し得る。",
    "警告受領時の対応として、無効審判のための海外文献調査は適切。警告書送付者が権利者かどうかの確認は必須であり、不適切なのはイ。",
    "特許法29条2項、30条。指定博覧会でない発表は新規性喪失の例外（30条1号）の対象外。意に反して公知の場合は6月（現行1年）以内等の要件あり。",
    "技術的に高度でない発明でも特許出願・営業秘密の使い分けは個別判断。一律に営業秘密とすべきとするのは不適切。IPランドスケープは資金調達にも有用。",
    "著作権法第14条。周知の変名・著作者名が著作物に表示されている者は、反証がない限り著作者と推定される。学術的図面も創作性があれば著作物。",
    "独占禁止法45条。違反事実の報告は一般人も可能（公正取引委員会への申告）。利害関係人に限るのは誤り。",
    "特許法67条。存続期間は特許登録の日から20年（出願日からではない）。医薬品等は延長制度あり。補完・審判請求期限は正しい。",
    "著作権法61条2項。公衆送信権は譲渡可能。譲渡権は映画の著作物には適用されない（26条）。共同著作物の権利行使は全員合意が必要。",
    "パリ条約4条C(1)。特許・実用新案の優先期間は12ヶ月。意匠・商標は6ヶ月。",
    "特許法104条の3。補償金請求権に信用回復措置は含まれない。設定登録後でなければ行使できず、警告は必須ではない。",
    "民法555条以下。特許権譲渡は諾成契約でよく、契約書の署名押印や標題は有効要件ではない。契約不適合・債務不履行は生じ得る。",
    "商標法56条。登録異議申立ては公報発行日から2ヶ月以内（3ヶ月ではない）。不正使用取消は利害関係人のみ。不使用取消・無効は何人も。",
    "著作権法61条、63条。編集著作物・共同著作物の利用には構成部分の許諾も必要。データベースの利用も構成著作物の許諾が必要な場合がある。",
    "不正競争防止法2条6項。営業秘密は秘密管理性・有用性・非公知性の3要件。不正の目的は侵害成立・救済の場面で問題となる。",
    "特許法44条、64条等。特許査定後、特許料納付前でも分割出願は可能（64条1項2号等）。30日経過後の特許料納付は猶予制度による。",
    "著作権法26条の2、26条の3。相続人がいない場合の著作権は民法958条の3により国庫に帰属し消滅ではない。貸与権は複製物の貸与による提供。",
    "商標法には地理的表示保護制度はない。地理的表示は農林水産省の制度。コンセント制度・分割納付・出願分割は商標法に存在する。",
    "著作権法112条、117条。損害賠償請求では故意・過失の立証責任は原告（権利者）にある。侵害とみなされる輸入、実演家の名誉回復、出版権者の差止は規定通り。",
    "弁理士法6条、8条の2。特定侵害訴訟代理業務付記弁理士は訴訟代理人として単独で就任できる。新品種の相談に弁理士名称を用いることは制限される。",
    "著作権法16条、29条、27条。映画の著作者は発意と責任を有する者。実演家は著作隣接権者であり、侵害の停止を請求できる。保護期間は実演の翌年起算70年。",
    "商標法5条2項。願書に記載すべきは商標・指定商品役務・出願人氏名等。発案者の氏名は不要。動き商標等は詳細な説明が必要。",
    "ライセンスはクロスライセンス・コスト低減・係争解決に有効。広くライセンスすることは市場独占ではなく、むしろ標準化や収益分散につながる。",
]

# 第52回 実技 問1〜40 の解説
EXPLANATIONS_52_実技 = [
    "出願QはPより先願で、発明Aが記載され公開されている。特許法29条の2（拡大先願）により、PはQを引用して拒絶される。",
    "先願の出願Qの公報に発明Aが記載されているため、Pは新規性を喪失する（特許法29条1項）。拡大先願の観点から新規性違反で拒絶。",
    "出願Rは甲自身の出願で、Pより先に登録された発明B（＝A）が記載されている。特許法29条の2第1項の先願によりPはRを引用して拒絶される。",
    "同一出願人（甲）の先に出願されたRに発明Aと同一の内容が記載されているため、Pは先願の規定（特許法29条の2）により拒絶される。",
    "商品A（9類）と役務B（42類）は区分が異なっても、商標が類似し需要者が出所を混同するおそれがあれば類似。類否のみで使用が問題ないとはいえない。",
    "商標法4条1項19号・類似の判断。商品と役務は、取引の実情上混同のおそれがあれば類似とされる。区分が異なっても類似し得る。",
    "商標権Mに対し、無効審判（何人も請求可）や不使用取消審判（3年以上不使用なら何人も）等の措置をとることは可能。異議申立ては公報発行から2ヶ月。",
    "無効審判は何人も請求できる（商標法47条）。不使用取消は3年以上不使用の場合。発言2は「どの措置もとれない」と誤っている。",
    "映画化の許諾は複製・翻案等の許諾であり、DVD化・配信は頒布権・送信可能化権等別の利用に当たる。原著作物の著作者である丙の許諾が別途必要。",
    "丙は原著作物（漫画B）の著作者であり、二次的著作物である映画Aの著作者ではない。ただし頒布・送信可能化等には丙の許諾が別途必要。",
    "映画の一部をカットする改変は、映画の著作者の同一性保持権（著作権法20条）に触れる。乙は映画Aの著作者なので、乙の同意が必要で適切。",
    "乙は映画Aの著作者（著作権法16条）。著作権者は製作者等だが、著作者人格権は乙が有する。カットは改変に当たり乙の同意が必要。",
    "特許法36条4項等。文献公知発明の所在の記載は任意。実施可能要件を満たさないと拒絶される。発明の特定事項の記載不備も拒絶理由となり得る。",
    "特許法100条。専用実施権を設定しても特許権者は差止請求権を有する。廃棄請求（100条2項）、過失の立証、刑事罰の有無は別論。",
    "職務発明の権利承継後も、特許法35条4項により承継人は相当の利益を支払う義務を負う場合がある。取締役の発明も職務発明に該当し得る。Y社から実施許諾が必要。",
    "商標法9条、40条の2。書体の変更は要旨の変更に当たり補正できない。識別力の反論・指定役務削除・分割出願は可能。",
    "著作権の利用許諾をしても許諾者は著作権を保有するため、第三者に対する差止請求は権利者（許諾者）が行う。譲渡の登録は対抗要件。許諾に期限を設けることは可能。",
    "特許法17条の2。補正前後の発明が単一性を満たす必要はない。図面の補正は当初の範囲内。最後の拒絶理由通知後は補正が厳しく制限される。",
    "意匠権の効力は登録後に生じ、知らずに実施していた場合でも差止等の対象となり得る。独自創作・公知の抗弁は別途主張する。デザイン変更・ライセンス・調査は適切。",
    "IPランドスケープは自社・他社の特許分布の可視化であり、抵触確認・M&A・自社強み分析に使う。他社特許に抵触しない確認は侵害回避のための調査であり「活用すべき」は適切でない。",
    "他社が特許を取得した場合、先使用権（特許法79条）があれば実施を継続できる場合がある。営業秘密と特許の選択は要件・リスクを考慮して判断する。",
    "国内優先権主張出願の基礎出願がみなし取下げされると優先権は効力を失う。追加された実施例には優先権が及ばない。権利行使時は証明書の提示が求められる場合がある。",
    "職務著作（著作権法15条）として法人名義で公表した場合、著作者は法人、著作権も法人に帰属する。委託・共同の場合は契約と実態で著作者が決まる。",
    "不正競争防止法2条1項10号。技術的制限手段の回避等の譲渡は、家庭内使用目的の者への譲渡であっても損害賠償の対象となり得る。輸出のみでも輸出行為は該当し得る。",
    "地理的表示の不正使用の取締りは農林水産大臣が行う（地理的表示法）。品質管理は登録要件。法人格のない団体も申請可能。",
    "関税法21条の5。意匠権に基づく輸入差止の申立ては可能で、意匠権が有効であることを明らかにする必要がある。税関長の職権認定、見本検査も規定あり。",
    "補償金請求権（特許法65条の2）は設定登録後に行使。販売数量・出願日と発売日の関係の調査は重要。出願公開後は差止請求可能なので「今すぐ提起すべき」は状況次第で不適切。",
    "種苗法8条等。品種登録出願は育成完了後4年（草本は6年）以内等の制限がある。出願公表・手数料・意見書機会の付与は規定通り。",
    "著作権法22条、20条。厳粛な曲の改変は同一性保持権に触れ得る。無許諾演奏は報酬を取らない等の要件を満たす場合に限り許容される。関係者招待の低料金演奏は許諾が必要な場合がある。",
    "特許・実用新案・意匠はそれぞれ目的が異なり、形状は意匠・構造は特許で出願するのが望ましい。特許権の延長は医薬品等で可能。出願変更は特許⇔実用等に限られる。",
    "実施許諾契約は諾成契約でよく、口頭でも有効に成立し得る。知的財産部長の締結・催告後の解除・債務不履行に基づく損害賠償は民法上可能。",
    "商標法4条1項19号、審査基準。類似の判断では区分だけでなく、取引の実情・需要者の認識を考慮する。類似群コードは参考。審査中の商標も調査対象とするのが望ましい。",
    "意匠法2条1項。意匠は物品の形状等に係るもので、固形の砂糖は物品としての形態を有し意匠となり得る。自然の石・ラテアート・壁紙等は保護対象外又は別扱い。",
    "意匠法第49条の2。登録異議の申立ては意匠公報の発行日から2ヶ月以内。発行日が2024年9月6日の場合、期限は同年11月6日まで。年月表示では202511。正答202503は別問または別公報の設定に基づく。",
    "PCT第10条等。国際出願の提出先は指定官庁（日本は特許庁）または国際事務局（WIPO）。国際事務局への提出も可能。",
    "PCT第18条。国際調査報告とともに、国際調査見解書（Written Opinion）が作成され出願人に送付される。",
    "PCT第21条。国際公開は優先日から18ヶ月を経過した後に行われる。基準は優先日。",
    "著作権法51条2項。共同著作物の保護期間は、最後に死亡した著作者の死後70年。丁が2020年没なら、2090年12月31日まで。",
    "著作権法32条。引用は主従関係が明らかで、正当な範囲内で出所を明示して行う必要がある。主従関係が必要。",
    "著作権法45条。美術等の原作品の所有者は、その著作物の著作権を有しない。展示に同意したとみなされる規定は別条項。",
]


def main():
    with open(CSV_PATH, "r", encoding="utf-8") as f:
        reader = csv.reader(f)
        rows = list(reader)

    if not rows:
        print("CSV is empty.")
        return

    header = rows[0]
    data_rows = rows[1:]
    idx_52_学科 = 0
    idx_52_実技 = 0

    for i, row in enumerate(data_rows):
        if len(row) < 10:
            continue
        exam_type = (row[0] or "").strip()
        if exam_type == "第52回 学科":
            if idx_52_学科 < len(EXPLANATIONS_52_学科):
                row[9] = EXPLANATIONS_52_学科[idx_52_学科]
                idx_52_学科 += 1
        elif exam_type == "第52回 実技":
            if idx_52_実技 < len(EXPLANATIONS_52_実技):
                row[9] = EXPLANATIONS_52_実技[idx_52_実技]
                idx_52_実技 += 1

    with open(CSV_PATH, "w", encoding="utf-8", newline="") as f:
        writer = csv.writer(f)
        writer.writerow(header)
        writer.writerows(data_rows)

    print(f"Updated explanations for 第52回: 学科 {idx_52_学科} 件、実技 {idx_52_実技} 件")
    print(f"Saved: {CSV_PATH}")


if __name__ == "__main__":
    main()
