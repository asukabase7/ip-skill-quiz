#!/usr/bin/env python3
"""
第51回・第50回の explanation を法的根拠に基づく解説文に更新する。
第52回の行は変更しない。
"""
import csv
import os

SCRIPT_DIR = os.path.dirname(os.path.abspath(__file__))
CSV_PATH = os.path.join(SCRIPT_DIR, "questions.csv")

# 第51回 学科 問1〜40
EXPLANATIONS_51_学科 = [
    "パブリシティ権は著作権法ではなく判例・不正競争防止法上の権利である。肖像権も同様に民法等に基づく。商品化権の定義はウのとおりであるため。",
    "商標法5条2項。動き商標・ホログラム商標等は願書に詳細な説明を記載しなければならない場合がある。複数商標の一願書出願は不可であるため。",
    "特許法36条4項。発明の詳細な説明は当業者が実施できる程度に明確かつ十分に記載しなければならない。請求項は詳細な説明に記載された範囲で解釈されるため。",
    "著作権法27条。二次的著作物の創作には原著作物の著作権者の許諾が必要である。編集著作物の利用には構成部分の許諾も必要となる場合があるため。",
    "特許法73条。特許権が共有に属するとき、専用実施権の設定は各共有者の同意が必要である。持分の譲渡・質権設定は他の同意不要であるため。",
    "特許法17条の2、意見書の規定。拒絶査定不服審判の請求と同時に、明細書に記載できなかった事項を意見書で述べることができる。補正は必ずしも狭くする必要はないため。",
    "著作権法77条。複製権又は公衆送信権を有する者は出版権を設定できる。著作権の移転は登録が対抗要件であり、効力発生要件ではないため。",
    "実用新案法29条の3。実用新案権者は評価書を提示して警告した後でなければ権利行使できない。著作権者・意匠権者・商標出願人は警告なしに行使できるため。",
    "弁理士法6条。特許原簿への登録の申請手続は弁理士の独占業務ではない。特許の有効性に関する鑑定は誰でも行える。商標登録出願・特許異議は独占業務であるため。",
    "商標法25条。商標権の効力は、役務の提供の用に供する物に商標を付する行為にも及ぶ。普通名称化した場合は効力が制限されることがあるため。",
    "著作権法32条。引用は出所を明示しなければならない。出所不明示は民事上の問題であり、罰則は著作権法119条等に限定される。翻訳しての引用は可能であるため。",
    "パリ条約4条C(1)。発明（特許・実用新案）の優先期間は12ヶ月である。意匠・商標は6ヶ月であるため。",
    "独占禁止法21条。権利の行使は適用除外となるが、権利消滅後の使用制限は私的独占の禁止等に触れる場合がある。販売価格制限・改良発明の帰属義務も問題となり得るため。",
    "特許法123条、178条。無効審決が確定すると特許権は初めから存在しなかったものとみなされる。審決取消訴訟は謄本送達から30日以内。消滅後も無効審判は請求可能であるため。",
    "特許法38条。特許権の共有者は共同して出願する必要がある。明細書の一部欠けは補完できる場合がある。方式・実体審査は出願審査請求がなくても方式審査等は行われるため。",
    "著作権法75条。無名・変名の著作者は実名の登録を受けることができる。侵害訴訟の提起に登録は不要。利用許諾は登録が対抗要件であるため。",
    "意匠法3条2項。機能のみの形状・公然知られた形状の容易創作・公知から1年超の意匠は登録不可。後願の他人登録意匠に類似する意匠は登録可能である場合があるため。",
    "特許法103条。知らないで実施している者に対する差止請求に警告は不要である。実用新案権者は評価書提示が要件。秘密意匠は警告後でなければ差止不可であるため。",
    "民法96条、110条。錯誤による取消しは善意無過失の第三者に対抗できない。錯誤は無効ではなく取消しの対象。虚偽表示は取り消し得る場合があるため。",
    "商標法19条、20条。更新は満了前6ヶ月から満了日までに申請する。使用していなくても更新は可能。専用使用権者の更新申請には商標権者の同意が必要であるため。",
    "著作権法101条。実演の保護期間は実演の行われた年の翌年から70年（101条1項）。レコード・放送等も同様に70年。有線放送は50年であるため。",
    "PCT第15条。国際調査は国際出願について行い、審査請求の有無にかかわらず行われる。出願人は国際調査報告受領後1回補正できる。先行技術を発見することを目的とするため。",
    "特許法35条4項。相当の利益は金銭に限られず、ストックオプション等も含む。発明者は使用者が権利を承継しても発明者として残る。通常実施権者も対価を請求できる場合があるため。",
    "特許法17条の2、30条。新規性喪失の例外は1年（旧6ヶ月）以内に出願等が必要。補正は原則として遡及効はない。査定送達前は一定の補正が可能であるため。",
    "IPランドスケープは技術・知財・ビジネス情報を可視化する業務であり、資金調達のための技術見える化も含まれる。研究開発成功・経営戦略・新規事業提案にも活用されるため。",
    "著作権法26条の3。上映権は著作権の一種である。映画の著作物には譲渡権の適用がない等の特則はあるが、上映権は享有するため。",
    "商標法4条1項19号等。他人の登録商標に類似していても、非類似商品であれば登録できる場合がある。著名な芸名は承諾があれば登録可能な場合があるため。",
    "特許調査の目的は、開発テーマ選定・技術トレンド把握・投資回避等である。特許されるか否かは審査官が判断するため、調査で正確に判断することは目的として不適切であるため。",
    "意匠法2条、24条。登録意匠の範囲は願書の記載に基づく。図面に代えて写真の提出は可能。判定を求めることは審査・審判の制度ではないため。",
    "不正競争防止法2条1項。営業秘密の不正取得・使用等は、知らなかった場合でも故意・過失があれば損害賠償の対象となり得る。常に該当するとは限らないため。",
    "特許法69条。試験又は研究のために特許発明を実施する行為は特許権の効力が及ばない。輸出のための所持・生産にのみ用いる物の譲渡は間接侵害に該当し得るため。",
    "特許法178条。審決取消訴訟は審決が確定した後でなければ提起できない。請求人は出願人に限られない。審判請求は拒絶謄本送達から3ヶ月以内。管轄は東京高裁であるため。",
    "独占戦略は市場拡大を速やかにできる利点がある。代替技術の加速・侵害監視・協力関係の困難はデメリットである。最も不適切なのはエであるため。",
    "商標法50条、56条。不正使用取消審判は利害関係人のみが請求できる。不使用取消は何人も。異議申立ては2ヶ月。無効は何人も請求できるため。",
    "著作権法15条。職務著作の要件は、法人等の業務に従事する者の作成・使用者の発意・契約等に別段の定めがないことである。相当の利益を与えることは要件ではないため。",
    "種苗法8条等。品種登録には単一の名称を付けて出願する。複数の名称を付けることはできない。依拠していないこと・出願公表・譲渡時期は規定のとおりであるため。",
    "著作権法112条、118条。輸入行為は侵害とみなされる（113条）。法人も罰則の対象となり得る。共同著作権者は単独で差止請求できる。レコード製作者は名誉回復措置を請求できるため。",
    "意匠法21条、26条。意匠権の実施は、特許権と抵触する場合には特許権者の許諾が必要となる。製造する行為は実施に含まれる。類否は需要者の視覚で判断するため。",
    "特許法71条。拒絶査定不服審判で争うのは進歩性・新規性・単一性等である。発明者が最初に完成したかは先願主義の下では審査の争点とならないため。",
    "著作権法59条。著作者人格権は一身専属権であり、相続されない。公表権・氏名表示権・同一性保持権（題号含む）は著作者人格権であるため。",
]

# 第51回 実技 問1〜40
EXPLANATIONS_51_実技 = [
    "特許法37条。請求項1と2は共通の特別な技術的特徴（発光装置aと制御装置bの結合）を有し、請求項2は請求項1に無線通信装置cを付加したもので単一性を満たすため。",
    "両請求項は同一の特別な技術的特徴（a+b）を有しており、単一性の要件（37条）を満たす。作用効果の相違は単一性の判断を妨げないため。",
    "特許法36条4項2号。特許出願の明細書には、発明の詳細な説明に、公知文献で記載された技術の所在を記載しなければならない場合がある。文献Bは記載要件に含まれるため。",
    "特許法36条4項。公知文献の所在の記載は、発明の詳細な説明の記載要件として求められている。特許文献以外でも、引用する文献は記載が必要となるため。",
    "商標法50条、判例。ローマ字「AOZORA」と平仮名「アオゾラ」は社会通念上同一の商標と認められる場合があり、使用は登録商標の使用に当たる。不使用取消にはならないため。",
    "登録商標「アオゾラ」と標章「AOZORA」は社会通念上同一の商標と認められ、指定商品である清涼飲料への使用は商標権の使用に当たる。不使用取消審判では取り消されないため。",
    "商標法51条。すべての指定商品に商標登録表示を付すと、表示が事実に反する場合に普通名称化を招き、不使用取消の対象となり得る。取り消されるおそれがあるため。",
    "指定商品の全部に登録表示を付すと、実際に使用していない指定商品についての表示となり、不使用取消審判で取り消される根拠となり得る。普通名称化とは別の観点であるため。",
    "著作権法30条。会議用の複製は「検討の過程」における利用に該当せず、私的使用（30条1号）の範囲を超える場合がある。制限規定が働くとはいえないため。",
    "会議用の人数分複製は、私的使用の範囲を超え、著作権法の制限規定（30条等）の適用されない場合がある。検討の過程における利用に該当しないため。",
    "著作権法20条。許諾を得て複製・翻案しても、改変して新たな絵柄を作成することは同一性保持権に触れる。著作者の同意が必要であるため。",
    "CM用に自由に改変することは、著作権法20条の同一性保持権の侵害に当たる。複製権の侵害とは別に、改変には著作者の同意が必要であるため。",
    "商標法4条1項8号。ありふれた氏名は承諾を得ても登録できない場合がある。創業者の氏名で相当の関連性があれば、承諾がなくても登録できる場合があるため。",
    "特許法69条。利用発明（従属発明）を実施するには、基本特許の実施許諾が必要である。転売先への警告・製造元への警告・警告後の損害賠償は別論であるため。",
    "特許法17条の2。最後の拒絶理由通知後は補正が厳しく制限され、分割出願・面接審査・意見書のみ提出は可能である。具体例追加の補正は新規事項となり得るため。",
    "著作権法38条。無許諾演奏は、営利を目的とせず、聴衆から料金を受けず、実演家に報酬が支払われない場合等に限り許容される。補償金を支払うことは要件ではないため。",
    "特許法105条の2。損害賠償請求において、侵害者の利益の額は権利者の損害額と推定される。過失の立証責任は原告にある。廃棄請求・刑事罰は別規定であるため。",
    "特許法30条。新規性喪失の例外は、公知日から1年以内に出願し、所定の書面を30日以内に提出する等の要件がある。同一でない発明は例外の適用を受けても登録できないわけではないため。",
    "特許権譲渡契約の解除により、債務不履行に基づく損害賠償請求は可能である。解除は催告後に履行がない場合等に認められる。軽微な違反では解除できない場合があるため。",
    "クロスライセンスは相互に実施許諾するため、自由度を高める効果がある。独占実施で参入防止・IPランドスケープの検討は適切。不適切なのは「自由度を高めない」とする発言であるため。",
    "特許権の存続期間は登録から20年である。9年10ヶ月経過後は残存期間が約10年あり、侵害品の製造を待てば権利消尽後にあたり侵害請求が難しくなる。待つ判断は状況により適切であるため。",
    "著作権法91条の2、96条。無断で実演を配信した場合、実演家は録音・録画権（91条の2）に基づき差止・損害賠償を請求できる。公表権・同一性保持権・譲渡権は別の権利であるため。",
    "形態模倣への対応として、特許・意匠・商標・著作権のいずれも検討対象となり得る。特許保護の検討は不適切ではなく、出願なしで差止めできるのは不競法のデッドコピー等であるため。",
    "不正競争防止法2条1項3号。意匠法の存続期間（25年）経過後も、不競法の3号（デッドコピー）により5年間は排除できる場合がある。意匠法と不競法の両方で保護され得るため。",
    "特許法30条1項。意に反して公知となった場合、公知日から1年以内に出願すれば新規性喪失の例外の適用を受け得る。同日出願なら喪失しない。海外展示会・予稿集・秘密保持は別要件であるため。",
    "種苗法3条等。品種登録要件には、特性の安定性・未譲渡性・区別性等がある。容易に品種改良できなかったこと（均一性・安定性の観点）は要件である。試験販売の時期確認は要件ではないため。",
    "他社特許発見時は、均等論・先使用権・無効調査・ライセンス交渉を検討する。ライセンス交渉を検討することは不適切ではなく、無効調査のみに頼るのは不適切であるため。",
    "商標法2条1項。商標は文字・図形・記号等からなる。音（起動音）は商標法上、音商標として登録の対象となる。料理の味は視覚的でないため登録対象外であるため。",
    "著作権法30条、38条。BGMが写り込んだ場合、主たる被写体の撮影に付随する軽微な利用として許諾不要とされる場合がある。被写体の承諾・オブジェの複製は別問題であるため。",
    "共同開発において、改良発明についても契約で帰属等を定めることが重要である。単独で特許取得できないわけではない。同意なくライセンスできないのは正しい。不適切なのはイであるため。",
    "意匠法23条、26条。専用実施権を設定しても、設定者は自己でも実施する権利を有するが、専用実施権の範囲内では実施が制限される。類否は需要者の視覚で判断するため。",
    "特許調査は出願前・開発中・書類作成後いずれの段階でも行う。書類作成後に調査しても完全な漏れなく把握できるわけではない。FI・Fタームは日本独自であるため。",
    "種苗法20条。育成者権は譲渡された種苗の利用に及ぶ場合がある。存続期間は原則25年（木本は30年）。特許法でも保護される場合がある。自家増殖には及ぶため。",
    "特許法107条、別表第一。特許料は請求項数・年数に応じて定まる。5請求項・8年分一括の計算に基づき17400円となるため。",
    "TRIPS協定は知的所有権の貿易関連の側面に関する協定であり、WTOの一括受諾協定である。正答はキであるため。",
    "マドリッド協定議定書は商標の国際登録に関する条約である。正答はエであるため。",
    "ハーグ協定は意匠の国際登録に関する条約である。正答はカであるため。",
    "著作権法29条。映画の著作物について、著作者が製作者に参加を約束した場合、著作権は製作者に帰属する。委託の場合は契約と実態に応じて判断されるため。",
    "著作権法16条。映画の著作者は、製作に発意と責任を有する者である。監督・撮影・美術等が該当する。正答はエであるため。",
    "漫画の利用許諾は、複製・翻案・頒布等の利用態様に応じて許諾を得る必要がある。正答はクであるため。",
]

# 第50回 学科 問1〜40
EXPLANATIONS_50_学科 = [
    "著作権法29条。映画製作者に参加を約束した著作者の著作権は、その映画の著作物について製作者に帰属する。共同著作物は分離して利用できない場合があるため。",
    "パリ条約4条の2。特許独立の原則は、各国で特許の付与・無効は独立して判断されることを意味する。国際出願の原則・無方式主義・最恵国待遇は別の原則であるため。",
    "商標法20条。商標権の更新登録の申請は、満了前6ヶ月から満了日までにすることができる。満了前3ヶ月からは誤り。登録料は分納可能。商標権者でなければ申請できないため。",
    "著作権法2条3項。映画の著作物は、物に固定されていなくても、連続した影像が映写できるものは保護される。地図・写真・WIPO登録は誤りであるため。",
    "特許法67条2項。国内優先権を主張した出願に基づく特許権の存続期間は、先の出願の日から20年とする。医薬品等は延長制度あり。審査請求から3年経過での延長はないため。",
    "特許法104条。損害賠償請求において、故意・過失の立証責任は原告（権利者）が負う。購入品の転売は権利消尽で侵害にならない場合がある。試験販売・譲渡のための所持は規定のとおりであるため。",
    "意匠法26条、29条。意匠権と特許権は同一の物品について併存することがある。出願前の準備行為には及ばない。類似範囲が重なれば実施は制限される。存続は20年で延長制度ありであるため。",
    "特許法123条、178条。無効審判の請求は利害関係人に限られ、利害関係のない自然人は請求できない。法人は利害関係があれば請求可能。審決取消訴訟は30日以内であるため。",
    "警告受領時は、先使用権（特許法79条）の成立の有無を検討することが適切である。判定請求は可能。20年経過は存続期間満了。J-PlatPatでの確認も有効であるため。",
    "著作権法27条の2、101条の2。実演家人格権は一身専属で譲渡できない。著作隣接権は譲渡可能。共同著作権者は単独で差止請求できる。不適切なのはアであるため。",
    "特許権の技術的範囲は請求項に基づいて定まる。構成要件が異なれば侵害を免れる場合がある。矛盾する主張は許されない。方法特許は使用・譲渡等にも及ぶため。",
    "特許法35条。職務発明について、従業者は相当の利益を受ける権利を契約等で定めることができる。予約承継・社長の発明・定款記載の有無は別論であるため。",
    "先行技術調査は、拒絶理由の未然防止・情報開示義務の履行・紛争回避に有効である。特許されるか否かは審査官が最終的に判断するため、正確に判断できるとは限らないため。",
    "拒絶理由通知への対応として、意見書の提出は任意である。必ず提出しなければならないわけではない。分割出願・意匠への変更・意見書のみ提出は可能であるため。",
    "弁理士法75条。特許料の納付手続は、弁理士でなくても行うことができる。審決取消訴訟の訴訟代理人は弁理士・弁護士に限られる。刑事罰・相手方の代理の制限は別規定であるため。",
    "特許法98条。通常実施権は登録が対抗要件である。期間の制限を付して許諾することは可能。共有者は全員の同意がなければ許諾できない。特許権者は自ら実施できるため。",
    "商標法56条、58条。不使用取消審判は何人も請求できる。慣用商標の異議申立ては2ヶ月。不正使用取消は利害関係人のみ。無効審判は何人も請求できるため。",
    "著作権法15条。職務著作の要件に「相当の利益を与える」は含まれない。プログラムの職務著作は公表不要でよい。業務上作成・発意に基づく・契約に別段の定めがないは要件であるため。",
    "特許法41条。意匠出願から特許出願への出願変更は認められない。国内優先権は意匠からは主張できない。1年6ヶ月の取下げみなし・放棄後の主張・公開後の主張は規定のとおりであるため。",
    "著作権法26条の3、26条の2。プログラムの著作物には頒布権が認められていない。音楽は貸与権、言語は口述権、映画は上映権を享有する。不適切なのはエであるため。",
    "特許法36条。一の願書で二以上の発明を記載して出願することができる。単一性を満たす必要がある。目的の記載・当業者が実施できる記載は必要。要約書は原則必要であるため。",
    "独占禁止法21条、ガイドライン。ライセンス契約において販売価格を制限することは不公正な取引方法に該当する場合がある。期間終了後の支払義務・改良発明の専用実施権義務も問題となり得るため。",
    "商標法25条、32条。商標権の効力の範囲は願書に記載した商標・指定商品に基づく。専用使用権の範囲内では権利者も使用が制限される場合がある。存続は10年で更新可能であるため。",
    "著作権法10条2項。法令・告示・通達は著作権の目的とならない。外国人の著作物は条約等に基づき保護される。3年以内・パリ条約の文言は不正確であるため。",
    "種苗法8条等。品種登録には単一の名称を付ける。複数の名称を付けて出願することはできない。依拠していないこと・遅滞なく公表・譲渡時期は規定のとおりであるため。",
    "民法555条、415条。売買契約において、売主は買主に対し目的物の引渡しを求める権利を有しない（買主が権利を有する）。損害賠償・減額請求は別の規定によるため。",
    "特許法36条の2の2。情報提供は何人でもでき、新規事項を追加する内容も理由となり得る。情報提供は義務ではない。書類の提出に限られないため。",
    "特許法39条。同一の発明について二以上の特許出願があるときは、最先の出願人のみが特許を受ける。同一出願人でも一発明について一特許。くじ・完成の先後ではないため。",
    "著作権法112条、114条。侵害には故意・過失が必要であり、過失がある場合でも刑事罰が科されるわけではない。予防請求・みなし侵害・依拠不要の侵害は規定のとおりであるため。",
    "関税法21条の5。輸入差止めを求めるには、認定手続の申立てを行う。税関長は裁判所の判決等に基づき没収・廃棄等を行う。特許庁長官の意見聴取は規定されているため。",
    "不正競争防止法2条6項。営業秘密は秘密管理性・有用性・非公知性を満たす必要がある。容易に作出できる情報は非公知性を欠く。退職者との契約・失敗事例・表示の有無は別論であるため。",
    "著作権法59条、18条の2。著作者人格権は著作者の一身に専属し、行使できない。公表権は行使できる。必要な改変は同一性保持権の侵害とならない。氏名表示権は有するため。",
    "IPランドスケープは、知財・技術・ビジネス等の情報を可視化したものであり、すべての情報を含み得る。経営判断・M&A・開発方針に活用されるため。",
    "意匠法3条1項3号、5条。他人の業務に係る物品と混同を生ずるおそれがある意匠は登録を受けない。混同のおそれがあれば登録不可。非類似なら登録可能な場合があるため。",
    "商標法3条2項。商標が使用により需要者に商品等の出所を認識させるに至ったときは、識別力があると認められる。俗称が含まれないとするのは誤りであるため。",
    "特許法29条。出願前に国内又は国外で公然実施された発明は新規性を喪失する。外国での公然実施・講演・出願後の公開は喪失事由。午後出願は同日であれば新規性を喪失しないため。",
    "著作権法30条、47条の2。プログラムのバックアップ複製は一定の条件下で許容される。有線放送・譲渡権・写り込みは規定のとおり。不適切なのはエであるため。",
    "PCT第34条。国際予備審査は選択的であり、すべての出願について行われるわけではない。1回の補正・国際調査報告の送付・国際公開は規定のとおりであるため。",
    "著作権法101条、4条。実演・レコード等の保護期間は翌年から70年。戦時加算・公表後70年は著作権の規定。構成員が取得するのは職務著作等であるため。",
    "商標法9条、10条。商標の類似に変更する補正は要旨の変更に当たり認められない。補正の却下・分割の可否・遅延は別規定による。正答はエであるため。",
]

# 第50回 実技 問1〜40
EXPLANATIONS_50_実技 = [
    "特許法48条の2。早期審査は、出願から2年以内に実施又は実施予定がある場合等に利用できる。発売が来年であれば2年以内の実施予定に該当し得るため。",
    "早期審査の要件の一つは、出願から2年以内に特許発明を実施する予定があることである。公開の要否・請求順は早期審査の理由ではないため。",
    "特許法17条の2、36条。出願後に完成した発明Bを補正で明細書に追加することは、新規事項の追加に当たり認められない。単一性があっても補正で追加はできないため。",
    "発明Bは出願Pの後に完成したものであり、出願時の明細書に記載がなく、補正で追加すると新規事項の追加となる。審査係属前でも手続で追加することはできないため。",
    "商標法37条。登録商標「リュックサック」と「クイーン」は、需要者が同一と認める場合は類似する。商品が類似し、商標も類似する場合、侵害を免れないため。",
    "「Queen」と「クイーン」は表記が異なるが、称呼・観念が共通し、商標として類似する場合がある。商品が類似し、商標が類似すれば効力範囲内となるため。",
    "意匠法29条の2。先使用権は、意匠登録出願前に日本国内で当該意匠又はこれに類似する意匠の実施の準備をしていた者に認められる。周知であることが要件ではないため。",
    "先使用権の成立には、出願前に国内で実施の準備をし、かつその意匠又は類似意匠が周知であったことが必要である。周知となっていなかったため、先使用権は成立しないため。",
    "著作権法38条。非営利・無料・無報酬であっても、公衆に送信する場合は、聴衆から料金を取らない等の要件を満たさない限り許諾が必要である。制限規定に当たらないため。",
    "非営利・無料・無報酬の祭りでの演奏を配信する行為は、著作権法38条の「公衆に送信しない」等の要件を満たさず、制限規定の適用を受けない場合があるため。",
    "著作権法10条2項、13条。国土地理院のデータに基づく表は、法令の翻訳・編集物として著作権の目的とならない場合がある。許諾なく使用できる場合があるため。",
    "国土地理院のデータに基づく表Bが著作権の目的とならない場合、許諾なく使用できる。著作権侵害・制限規定の適用ではなく、著作物に該当しないため。",
    "関税法21条の12。輸入差止の認定を受けた物品について、輸入を止めることができ、積戻し命令・没収廃棄等の手続がある。グリップを取り外しても輸入が認められるかは個別判断であるため。",
    "比較広告により信用を害された場合、不正競争防止法（2条1項14号等）に基づき損害賠償・信用回復措置を請求できる。信用を害されたことが不正競争であることの理由にはならないため。",
    "特許法36条4項。発明の詳細な説明は、当業者が実施できる程度に明確かつ十分に記載しなければならない。補完は一定の場合に可能。十分記載しないほうがよいは誤りであるため。",
    "著作権法63条。利用許諾は登録が対抗要件であり、効力発生要件ではない。許諾契約は登録がなくても有効に成立する。複製権・譲渡権・期間の制限は許諾の内容によるため。",
    "IPランドスケープは経産省の制度ではなく、特許等の情報を可視化する分析手法である。消極的目的のみでは不十分とするのは誤り。M&A提案に有効であるため。",
    "商標法30条。通常使用権は指定商品又は指定役務ごとに許諾できる。分離して移転することはできない。口紅・香水は指定が異なれば別の通常使用権となる。W社への許諾は契約によるため。",
    "未請求の出願も調査対象とすべきである。将来請求されれば権利化されるため。構成要件の置換が侵害となるかは均等論による。出願か秘匿かの判断は重要であるため。",
    "特許法30条。新規性喪失の例外の適用を受けるには、公知となった日から1年以内に出願し、所定の書面を30日以内に提出する等の要件がある。Y国公報でも例外は適用され得るため。",
    "特許法69条。特許権者から正当に購入した製品の使用は、権利消尽により侵害とならない。製造者が侵害の主体となる。先使用権・調査目的は別規定であるため。",
    "職務発明の権利を承継した後、従業者が退職して他社（Y社）で実施する場合、Y社は承継した権利に基づき実施する権利を有する。X社は通常実施権を有しないため。",
    "著作権法112条、117条。共同著作権者は、単独で差止請求・損害賠償請求ができる。名誉回復措置は著作者人格権の侵害について認められる。不当利得返還は可能であるため。",
    "特許調査において、NOT検索・AND検索は基本的な演算である。主テーマのみで検索すると漏れが生じる。検索式の組み合わせが不適切な例として主テーマのみが挙げられるため。",
    "意匠法13条。特許出願を意匠登録出願に変更することはできない。部分意匠・関連意匠・秘密意匠は意匠法の制度である。商標への変更は可能な場合があるため。",
    "無効審判の請求にあたり、請求人の名義は真正な権利者である必要がある。関係のない会社名義で請求することは不適切である。原簿確認・出願中の調査は適切であるため。",
    "商標法5条2項。色彩のみからなる商標は、その色彩のみでは登録を受けられない場合がある。標準文字・区分記載は願書の記載事項。2ヶ所記載は誤りであるため。",
    "著作権法2条3項。映画の著作物には、連続した影像が記録されたものが含まれる。動画も映画の著作物として保護され得る。私人の翻訳・工芸品・工業製品は別規定であるため。",
    "民法541条、415条。契約違反があっても、解除・損害賠償・強制履行のいずれも場合により認められる。持ち帰れないは契約内容による。無効・解除は法定の要件によるため。",
    "意匠の開発・出願にあたり、権利の帰属を契約で定めることが重要である。すべて譲渡・すぐ出願・譲渡条項は戦略による。不適切なのは「すべて譲渡」等を一律に選ぶことであるため。",
    "他社特許を回避する方策として、無効審判の請求は有効である。試験販売・購入して組み込む・無効の抗弁も方策となり得る。無効審判は争いを根本から解決し得るため。",
    "商標法36条、39条。商標権者は、侵害者に対し差止・損害賠償・信用回復措置（謝罪広告等）を請求できる。廃棄の請求も可能である。子会社への請求は権利者により可能であるため。",
    "種苗法20条。育成者権は、譲渡された種苗の利用に及ぶ場合がある。存続期間は原則25年（木本は30年）。特許法での保護・自家増殖への及ぶは規定のとおりであるため。",
    "特許法107条、別表第一。請求項数・年数に応じた特許料の計算に基づき、28請求項・8年分一括では292200円となるため。",
    "WTO紛争解決手続に基づき、知的所有権に関する紛争も処理される。正答はキであるため。",
    "商標の国際登録はマドリッド協定議定書に基づく。正答はエであるため。",
    "意匠の国際登録はハーグ協定に基づく。正答はカであるため。",
    "著作権法29条。映画の著作物について、著作者が製作者に参加を約束した場合、著作権は製作者に帰属する。委託制作の場合は契約に従い判断されるため。",
    "著作権法16条。映画の著作者は、製作に発意と責任を有する者である。監督・撮影等が該当する。正答はエであるため。",
    "漫画の利用に際しては、複製・翻案・頒布等の利用態様に応じた許諾が必要である。正答はクであるため。",
]


def main():
    with open(CSV_PATH, "r", encoding="utf-8") as f:
        reader = csv.reader(f)
        rows = list(reader)

    if not rows:
        print("CSV is empty.")
        return

    header = rows[0]
    data_rows = rows[1:]
    idx_51_学科 = 0
    idx_51_実技 = 0
    idx_50_学科 = 0
    idx_50_実技 = 0

    for row in data_rows:
        if len(row) < 10:
            continue
        exam_type = (row[0] or "").strip()
        if exam_type == "第52回 学科" or exam_type == "第52回 実技":
            continue  # 第52回は変更しない
        if exam_type == "第51回 学科":
            if idx_51_学科 < len(EXPLANATIONS_51_学科):
                row[9] = EXPLANATIONS_51_学科[idx_51_学科]
                idx_51_学科 += 1
        elif exam_type == "第51回 実技":
            if idx_51_実技 < len(EXPLANATIONS_51_実技):
                row[9] = EXPLANATIONS_51_実技[idx_51_実技]
                idx_51_実技 += 1
        elif exam_type == "第50回 学科":
            if idx_50_学科 < len(EXPLANATIONS_50_学科):
                row[9] = EXPLANATIONS_50_学科[idx_50_学科]
                idx_50_学科 += 1
        elif exam_type == "第50回 実技":
            if idx_50_実技 < len(EXPLANATIONS_50_実技):
                row[9] = EXPLANATIONS_50_実技[idx_50_実技]
                idx_50_実技 += 1

    with open(CSV_PATH, "w", encoding="utf-8", newline="") as f:
        writer = csv.writer(f)
        writer.writerow(header)
        writer.writerows(data_rows)

    print(f"Updated: 第51回 学科 {idx_51_学科} 件、実技 {idx_51_実技} 件")
    print(f"        第50回 学科 {idx_50_学科} 件、実技 {idx_50_実技} 件")
    print(f"Saved: {CSV_PATH}")


if __name__ == "__main__":
    main()
